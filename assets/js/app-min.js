const grid=document.querySelector("#grid .grid");grid.addEventListener("click",(function(e){e.target.classList.toggle("fill")})),document.querySelector("#generate-puzzle").addEventListener("click",(function(e){clearGrid(),clearPuzzle();const t=document.querySelector("#puzzle-width").value,r=document.querySelector("#puzzle-height").value;generateGrid(`${t}x${r}`)})),document.querySelector("#generate-clues").addEventListener("click",(function(e){clearPuzzle(),buildPuzzle(grid.classList[1]),e.preventDefault()}));const generateGrid=function(e){let t=e.split("x"),r=parseInt(t.shift()),l=parseInt(t.shift());grid.innerHTML="",grid.className="grid",grid.classList.add(e),grid.style.width=3*r+.5+"rem",grid.style.gridTemplateColumns=`repeat(${r}, 3rem)`,grid.style.gridTemplateRows=`repeat(${l}, 3rem)`;for(var n=0;n<r*l;n++)grid.innerHTML+="<div></div>";document.querySelector("#grid").style.display="flex",document.querySelector("#generate-button-wrapper").style.display="flex"},buildPuzzle=function(e){const t=Array.from(document.querySelectorAll("#grid .grid div"));let r=e.split("x"),l=parseInt(r.shift()),n=parseInt(r.shift()),i=l,s=[];for(let e=0;e<n;e++)s[e]=[];let d=[];for(let e=0;e<l;e++)d[e]=[];for(let e=0;e<t.length;e++){let r=Math.floor(e/i);s[r][e-r*i]=t[e].classList.contains("fill"),d[e-r*i][r]=t[e].classList.contains("fill")}let c=buildClues(s,d);const u=document.createElement("div");u.classList.add("clue");var o=grid.cloneNode(!0);o.removeAttribute("id"),o.style.gridColumn="2 / span "+(parseInt(l)+2),o.style.gridRow="2 / span "+(n+2),u.style.gridTemplateColumns=`auto .25rem repeat(${l}, 3rem) .25rem`,u.style.gridTemplateRows=`auto .25rem repeat(${n}, 3rem) .25rem`,u.innerHTML=c,u.appendChild(o),document.querySelector("#clue-grid").append(u),document.querySelector("#clue-grid").style.display="flex"},clearGrid=function(){document.querySelector("#grid").style.display="none",document.querySelector("#generate-button-wrapper").style.display="none",document.querySelector("#grid .grid").innerHTML=""},clearPuzzle=function(){document.querySelector("#clue-grid").style.display="none",document.querySelector("#clue-grid").innerHTML=""},buildClues=function(e,t){let r="";for(let t=0;t<e.length;t++)r+=`<span class="row" style="grid-column: 1; grid-row: ${t+3};">`+calculateClues(e,t)+"</span>";for(let e=0;e<t.length;e++)r+=`<span class="col" style="grid-column: ${e+3}; grid-row: 1;">`+calculateClues(t,e)+"</span>";return r},calculateClues=function(e,t){let r="",l=0,n=[];for(let t=0;t<e.length;t++)n[t]=[];for(let i=0;i<e[t].length;i++)e[t][i]?l++:l>0&&(n[t].push(l),r+=`<span>${l}</span>`,l=0),i===e[t].length-1&&l>0&&(n[t].push(l),r+=`<span>${l}</span>`,l=0);return 0===n[t].length&&(r+=`<span>${l}</span>`),r};